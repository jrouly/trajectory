{% extends 'layout/base.html' %}

{% block title %}Topics{% endblock %}

{% block content %}

<div class="page-header">
  <div class="row">
    <div class="col-lg-12">
      <h1>Topics</h1>
    </div>
  </div>
</div>

{% if topics %}
<div class="row">
  <div class="col-lg-12">
    <div class="form-horizontal" action="" method="get">

      <div class="form-group">
        <div class="col-lg-12">
          <div class="input-group">
            <span class="input-group-addon"><i class="fa fa-search"></i></span>
            <input type="text" class="form-control" autocomplete="off"
            placeholder="Topic words" id="search-topics"
            data-list="#topic-list">
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<div class="row">
  <div class="col-lg-12">

    <ul class="list-group" id="topic-list">
      {% for topic in topics %}

      <li class="list-group-item clickable"
        data-toggle="collapse" data-target="#docs{{ loop.index }}">
        <span class="badge">{{ topic.course_assocs|count }}</span>

        <i class="fa fa-caret-right"></i>&nbsp;
        {{ topic.words }}

        <div class="collapse" id="docs{{ loop.index }}">
          <p></p>

          {% for course_assoc in topic.course_assocs %}
          {% set course = course_assoc.course %}
          <p>({{ '%.3f' % course_assoc.proportion }})
          <strong><a href="/universities/{{course.department.university.abbreviation}}/{{course.department.abbreviation}}.html#{{course.id}}">
            {{ course.department.university.abbreviation }}
            {{course.department.abbreviation}}
            {{course.number}}</a></strong>
          <em>{{course.title}}</em></p>
          {% endfor %}
        </div>

      </li>

      {% endfor %}
    </ul>
  </div>
</div>

{% else %}
<div class="row">
  <div class="col-lg-12">
    <p class="warning">No topics inferred.<p>
  </div>
</div>
{% endif %}

{% endblock %}
